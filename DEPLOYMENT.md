# FieldTrack Pro - Production Deployment Guide

## ‚úÖ Production Readiness Checklist

### 1. **Service Worker & Caching**
- ‚úÖ Versioned service worker (`public/sw.js`) with cache management
- ‚úÖ Automatic cache invalidation on version updates
- ‚úÖ Network-first strategy with offline fallback
- ‚úÖ Auto-reload when new version is available
- ‚úÖ Toast notification: "FieldTrack Pro updated. Reloading..."

### 2. **Login Persistence**
- ‚úÖ Session saved in localStorage
- ‚úÖ Session saved in memory (AuthContext)
- ‚úÖ Auto-restore on app reload
- ‚úÖ Persists across updates and device restarts
- ‚úÖ Only cleared on manual sign out

### 3. **PWA Support**
- ‚úÖ Manifest.json configured
- ‚úÖ App installable on mobile devices
- ‚úÖ Proper theme colors (Martin Builder green)
- ‚úÖ Standalone display mode
- ‚úÖ Portrait orientation optimized

### 4. **Mobile & Camera Support**
- ‚úÖ Camera permissions for photo upload
- ‚úÖ Responsive design (mobile-first)
- ‚úÖ Touch targets (44px minimum)
- ‚úÖ GPS location tracking
- ‚úÖ Works on iOS and Android

### 5. **Production Build Optimizations**
- ‚úÖ Code splitting (vendor, supabase chunks)
- ‚úÖ Sourcemaps for debugging
- ‚úÖ Optimized bundle size
- ‚úÖ HTTPS ready (OnSpace handles this)

---

## üöÄ Deployment Steps

### **Step 1: Publish to Production**

1. Click the **"Publish"** button in the top-right toolbar
2. Select **"Publish to Production"** (NOT preview)
3. Choose your production URL:
   - **Default**: `https://martinbuilder.onspace.app` (recommended)
   - **Custom**: Set up custom domain like `https://app.martinbuilder.com`

### **Step 2: Custom Domain Setup (Optional)**

If you want to use `app.martinbuilder.com`:

1. Click **"Publish"** ‚Üí **"Add Existing Domain"**
2. Enter your domain: `app.martinbuilder.com`
3. Follow OnSpace's DNS configuration instructions:
   - Add CNAME record pointing to OnSpace servers
   - Wait for DNS propagation (5-60 minutes)
4. SSL certificate will be auto-generated by OnSpace

### **Step 3: Verify Production Deployment**

After publishing, verify these features work:

#### **Authentication**
- [ ] Sign up with email + OTP verification
- [ ] Log in with email + password
- [ ] Session persists across page reloads
- [ ] Session persists after closing/reopening browser
- [ ] Sign out clears session

#### **Office Dashboard** (role: office)
- [ ] View all jobs
- [ ] Create new jobs
- [ ] Upload documents to job folders
- [ ] Manage global components
- [ ] Assign components to jobs
- [ ] View all time entries
- [ ] View all daily logs
- [ ] View all photos
- [ ] Export logs as CSV

#### **Crew Dashboard** (role: crew)
- [ ] View assigned jobs
- [ ] Start/pause/resume/stop timer
- [ ] Manual time entry
- [ ] Take photos with device camera
- [ ] Upload photos with GPS metadata
- [ ] Submit daily logs (issues, materials, notes)
- [ ] View job documents

#### **Mobile Features**
- [ ] Camera access works on iOS
- [ ] Camera access works on Android
- [ ] GPS location captured correctly
- [ ] App works offline (cached assets)
- [ ] Responsive on phone/tablet
- [ ] PWA install prompt appears

---

## üîÑ Update Process

When you make changes and publish a new version:

1. **Build & Publish**: Click "Publish" to deploy new version
2. **Service Worker Updates**: Automatically detects new version
3. **User Experience**:
   - User sees toast: "FieldTrack Pro updated. Reloading..."
   - App auto-reloads after 2 seconds
   - New version loads cleanly
   - No white screens or broken states
   - Login session preserved

---

## üì± Progressive Web App (PWA)

Users can install FieldTrack Pro on their devices:

### **iOS Installation**
1. Open production URL in Safari
2. Tap "Share" button
3. Scroll down and tap "Add to Home Screen"
4. Tap "Add"
5. App icon appears on home screen

### **Android Installation**
1. Open production URL in Chrome
2. Tap the "Add to Home Screen" prompt
3. Or: Menu ‚Üí "Add to Home Screen"
4. App installs like a native app

---

## üîí Security & Performance

- **HTTPS**: OnSpace serves all apps over HTTPS
- **Authentication**: Supabase handles secure auth
- **RLS Policies**: Database access restricted by role
- **Asset Caching**: Static assets cached for speed
- **Code Splitting**: Optimized bundle loading
- **Service Worker**: Version-based cache management

---

## üìä Production Monitoring

### **Check Logs**
Use OnSpace's Cloud Dashboard ‚Üí Log tab:
- Edge Function errors
- Database errors
- Authentication issues

### **Test on Real Devices**
- iPhone (Safari)
- Android (Chrome)
- Desktop (Chrome, Firefox, Safari)

---

## ‚úÖ Final Production URL

After publishing, your app will be available at:

**Default Production URL:**
```
https://martinbuilder.onspace.app
```

**Or Custom Domain:**
```
https://app.martinbuilder.com
```

---

## üéØ Post-Deployment Checklist

- [ ] Production URL is live and accessible
- [ ] Login works correctly
- [ ] Both crew and office roles function properly
- [ ] Camera access works on mobile devices
- [ ] GPS location captures correctly
- [ ] Photos upload successfully
- [ ] Time tracking persists correctly
- [ ] Daily logs save and display
- [ ] Service worker caching works
- [ ] Updates deploy without breaking app
- [ ] Users stay logged in across updates

---

## üêõ Troubleshooting

### **Users Stuck on Old Version**
- Hard refresh: Ctrl+Shift+R (Windows) or Cmd+Shift+R (Mac)
- Clear browser cache
- Unregister service worker: DevTools ‚Üí Application ‚Üí Service Workers ‚Üí Unregister

### **Camera Not Working**
- Check HTTPS is enabled (required for camera)
- Check browser permissions
- Try different browser (Safari for iOS, Chrome for Android)

### **Login Not Persisting**
- Check browser allows localStorage
- Check cookies aren't blocked
- Try incognito mode to test

---

## üìû Support

For production deployment assistance:
- **Email**: contact@onspace.ai
- **Documentation**: OnSpace Cloud Dashboard
- **Logs**: Cloud ‚Üí Log tab

---

**Your FieldTrack Pro app is now production-ready! üéâ**
